
#Creamos tabla temporal
CREATE TABLE twitter_data(twitter_val STRING);

#Hay que cargar el fichero https://raw.githubusercontent.com/mruzmar/bigdata/master/Hive/practica-drivers/drivers.csv en HDFS en la ruta /home/info/drivers.csv

LOAD DATA INPATH '/home/info/drivers.csv' OVERWRITE INTO TABLE temp_drivers;

select * from temp_drivers limit 100;

CREATE TABLE drivers (driverId INT, name STRING, ssn BIGINT, location STRING,
certified STRING, wageplan STRING);


insert overwrite table drivers
SELECT
regexp_extract(col_value, '^(?:([^,]*),?){1}', 1) driverId,
Ejemplo Hive
regexp_extract(col_value, '^(?:([^,]*),?){2}', 1) name,
regexp_extract(col_value, '^(?:([^,]*),?){3}', 1) ssn,
regexp_extract(col_value, '^(?:([^,]*),?){4}', 1) location,
regexp_extract(col_value, '^(?:([^,]*),?){5}', 1) certified,
regexp_extract(col_value, '^(?:([^,]*),?){6}', 1) wageplan
from temp_drivers;


select * from temp_drivers limit 100;


CREATE TABLE temp_timesheet (col_value string);

#Hay que cargar el fichero https://github.com/mruzmar/bigdata/blob/master/Hive/practica-drivers/timesheet.csv en HDFS en la ruta /home/info/

LOAD DATA INPATH '/home/info/timesheet.csv' OVERWRITE INTO TABLE
temp_timesheet;


select * from temp_timesheet limit 100;


CREATE TABLE timesheet (driverId INT, week INT, hours_logged INT , miles_logged INT);
insert overwrite table timesheet
SELECT
regexp_extract(col_value, '^(?:([^,]*),?){1}', 1) driverId,
regexp_extract(col_value, '^(?:([^,]*),?){2}', 1) week,
regexp_extract(col_value, '^(?:([^,]*),?){3}', 1) hours_logged,
regexp_extract(col_value, '^(?:([^,]*),?){4}', 1) miles_logged
from temp_timesheet;


select * from temp_timesheet limit 100;


SELECT driverId, sum(hours_logged), sum(miles_logged) FROM timesheet GROUP BY
driverId;




